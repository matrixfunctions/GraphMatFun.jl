<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Graphs and their manipulation · GraphMatFun.jl</title><link rel="canonical" href="https://matrixfunctions.github.io/GraphMatFun.jl/graph/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GraphMatFun.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Graphs and their manipulation</a><ul class="internal"><li><a class="tocitem" href="#Manipulating-graph-topology"><span>Manipulating graph topology</span></a></li><li><a class="tocitem" href="#Evaluating-of-graph"><span>Evaluating of graph</span></a></li><li><a class="tocitem" href="#Linear-combinations-and-coefficients"><span>Linear combinations and coefficients</span></a></li><li><a class="tocitem" href="#Reading-and-writing-to-file"><span>Reading and writing to file</span></a></li></ul></li><li><a class="tocitem" href="../generators/">Built-in graphs</a></li><li><a class="tocitem" href="../optim/">Graph optimization</a></li><li><a class="tocitem" href="../code_gen/">Code generation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Graphs and their manipulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Graphs and their manipulation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/master/docs/src/graph.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Graphs-and-their-manipulation"><a class="docs-heading-anchor" href="#Graphs-and-their-manipulation">Graphs and their manipulation</a><a id="Graphs-and-their-manipulation-1"></a><a class="docs-heading-anchor-permalink" href="#Graphs-and-their-manipulation" title="Permalink"></a></h1><h2 id="Manipulating-graph-topology"><a class="docs-heading-anchor" href="#Manipulating-graph-topology">Manipulating graph topology</a><a id="Manipulating-graph-topology-1"></a><a class="docs-heading-anchor-permalink" href="#Manipulating-graph-topology" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.Compgraph" href="#GraphMatFun.Compgraph"><code>GraphMatFun.Compgraph</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">graph=Compgraph(T::Type=ComplexF64)</code></pre><p>Creates an empty computation graph of with coefficients of type <code>T</code>.</p><p></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L39-L44">source</a></section><section><div><pre><code class="language-none">graph=Compgraph(T,orggraph::Compgraph)</code></pre><p>Converts a graph such that the coefficients become type <code>T</code>. Note that <code>T</code> can be a <code>Number</code> but can be other objects with defined operations, or just <code>Any</code>.</p><p></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L50-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.add_mult!" href="#GraphMatFun.add_mult!"><code>GraphMatFun.add_mult!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_mult!(graph,node,p1,p2)</code></pre><p>Adds a multiplication of node <code>p1</code> and <code>p2</code> to the <code>graph</code>. The result is stored in node <code>node</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L92-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.add_lincomb!" href="#GraphMatFun.add_lincomb!"><code>GraphMatFun.add_lincomb!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_lincomb!(graph,node,α1,p1,α2,p2)</code></pre><p>The operation <code>α1*p1+α2*p2</code> is added to the graph. The result is stored in node <code>node</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L104-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.add_ldiv!" href="#GraphMatFun.add_ldiv!"><code>GraphMatFun.add_ldiv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_ldiv!(graph,node,p1,p2)</code></pre><p>The operation <code>inv(p1)*p2</code> is added to the graph. The result is stored in node <code>node</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.add_sum!" href="#GraphMatFun.add_sum!"><code>GraphMatFun.add_sum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cref=add_sum!(graph,node,c,nodelist,base_name=node)</code></pre><p>Adds a linear combination of more than two nodes, given in <code>nodelist::Vector</code>, with coefficients given in <code>c</code>. The <code>base_name</code> is temporary variables for the summing. The sum is stored in <code>node</code>.</p><p>Returns <code>cref</code> list with references.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L227-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.add_output!" href="#GraphMatFun.add_output!"><code>GraphMatFun.add_output!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_output!(graph,node)</code></pre><p>Adds an output <code>node</code> to the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L129-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.del_output!" href="#GraphMatFun.del_output!"><code>GraphMatFun.del_output!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">del_output!(graph,node)</code></pre><p>Removes the output <code>node</code> from the list of output nodes of the graph. This function does not remove the node from the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L142-L147">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.clear_outputs!" href="#GraphMatFun.clear_outputs!"><code>GraphMatFun.clear_outputs!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">clear_outputs!(graph)</code></pre><p>Clears the list of output nodes of the graph. This function does not remove the node nodes from the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L152-L157">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.rename_node!" href="#GraphMatFun.rename_node!"><code>GraphMatFun.rename_node!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rename_node!(graph,src,dest,cref=Vector())</code></pre><p>This changes the name of the node <code>src</code> to <code>dest</code> and updating all references to the node including coefficient references in <code>cref</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L162-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.del_node!" href="#GraphMatFun.del_node!"><code>GraphMatFun.del_node!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">del_node!(graph,node)</code></pre><p>Deletes a node from the graph, and all data associated with it, except for <code>graph.outputs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L267-L272">source</a></section></article><h2 id="Evaluating-of-graph"><a class="docs-heading-anchor" href="#Evaluating-of-graph">Evaluating of graph</a><a id="Evaluating-of-graph-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-of-graph" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.eval_graph" href="#GraphMatFun.eval_graph"><code>GraphMatFun.eval_graph</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">result=eval_graph(graph, x; vals=nothing,
                  input=:A, output=size(graph.outputs,1),
                  comporder=nothing)</code></pre><p>Evaluates a graph in the value <code>x</code> which is typically a scalar value or a matrix. If <code>x</code> is a Vector, the values will be evaluated  elementwise.</p><p>The <code>comporder</code> is a <code>Vector</code> of nodes specifying in which order the graph should be computed. By default <a href="#GraphMatFun.get_topo_order"><code>get_topo_order</code></a> is used.</p><p>The <code>output</code> is an <code>Int</code> specifying which node should be considered as output. The output node is <code>graph.outputs[output]</code>.</p><p>The <code>vals</code> is used to inspect contents other than the output inside the graph. Typically <code>vals</code> is a <code>Dict</code>. It will be modified to contain the computed nodes of the graph. If we wish to inspect node <code>X3</code>, we can initiate an empty dict as input:</p><pre><code class="language-julia-repl">julia&gt; vals=Dict{Symbol,Any}();
julia&gt; eval_graph(graph,A,vals=vals);
julia&gt; vals[:X3]
</code></pre><p></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/eval.jl#L12-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.get_topo_order" href="#GraphMatFun.get_topo_order"><code>GraphMatFun.get_topo_order</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">(order,can_be_deallocated,max_nodes)=get_topo_order(graph; priohelp=Dict{Symbol,Float64}(),free_mem_bonus=1000,will_not_deallocate=[:I],input=:A)</code></pre><p>Computes a topological sort of <code>graph</code>, that is, an ordering of the nodes following which the function the graph represents can be evaluated. The <code>priohelp</code> kwarg can be used to obtain a different topological ordering by changing the node priority. The code assumes that the nodes <code>:I</code> and <code>input</code> do not need to be computed.</p><p>The code uses a heuristic to minimize pathwidth. It is based on a point system. You can influence the computation order by providing a <code>priohelp</code>. If you want node <code>:B4</code> to be computed earlier,  you can set <code>priohelp[:B4]=-5000.0</code>.  The <code>free_mem_bonus</code> is used in the heuristic to prioritize the computation of nodes which release other nodes. The vector <code>will_not_deallocate</code> influences the order specifying nodes that will not be deallocated and therefore gets no <code>free_mem_bonus</code>.</p><p>The return value <code>order</code> is a <code>Vector</code> of Symbols, and <code>can_be_deallocated</code> is a <code>Vector{Vector{Symbol}}</code> where the element <code>i</code> specifies the <code>Symbols</code> that are unused after step <code>i</code> in the ordering. The <code>max_nodes</code> is the pathwidth.</p><p></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L556-L580">source</a></section></article><h2 id="Linear-combinations-and-coefficients"><a class="docs-heading-anchor" href="#Linear-combinations-and-coefficients">Linear combinations and coefficients</a><a id="Linear-combinations-and-coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-combinations-and-coefficients" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.get_all_cref" href="#GraphMatFun.get_all_cref"><code>GraphMatFun.get_all_cref</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">v=get_all_cref(graph)</code></pre><p>Returns a list with references to all coefficients in the graph. The list is sorted.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L332-L336">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.get_coeffs" href="#GraphMatFun.get_coeffs"><code>GraphMatFun.get_coeffs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">x=get_coeffs(graph, cref=get_all_cref(graph))</code></pre><p>Gets the coefficient values for the coefficients specified in <code>cref::Vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L502-L506">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.set_coeffs!" href="#GraphMatFun.set_coeffs!"><code>GraphMatFun.set_coeffs!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_coeffs!(graph, x, cref=get_all_cref(graph))</code></pre><p>Sets the coefficient values in the coefficients specified in <code>cref::Vector</code> to the values in the vector in <code>x::Vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L474-L478">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.extract_sums" href="#GraphMatFun.extract_sums"><code>GraphMatFun.extract_sums</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">v=extract_sums(graph)</code></pre><p>::Vector{Tuple{Vector{Float64},Vector{Symbol},Vector{Symbol}}}`</p><p>Returns a representation of sums in <code>graph</code> which may potentially be merged. The vector <code>sums</code> contains a tuple for each of these sums. The three entries of the tuple are:</p><ul><li>a vector of <code>Float64</code> values that represent the coefficients of the summands;</li><li>a vector of <code>Symbol</code>s that correspond to the summands; and</li><li>a vector of intermediate <code>Symbol</code>s (i.e, nodes) that can be merged.</li></ul><p>The first two vectors have the same number of entries, one for each element that can be merged in the sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L348-L363">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.get_sorted_keys" href="#GraphMatFun.get_sorted_keys"><code>GraphMatFun.get_sorted_keys</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">v=get_sorted_keys(graph)</code></pre><p>Returns a list of all nodes, sorted.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct.jl#L323-L327">source</a></section></article><h2 id="Reading-and-writing-to-file"><a class="docs-heading-anchor" href="#Reading-and-writing-to-file">Reading and writing to file</a><a id="Reading-and-writing-to-file-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-and-writing-to-file" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.export_compgraph" href="#GraphMatFun.export_compgraph"><code>GraphMatFun.export_compgraph</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">export_compgraph(graph, fname; main_output=nothing,
                 order=get_topo_order(graph)[1],
                 fun=&quot;&quot;, dom=&quot;&quot;, err=&quot;&quot;, genby=&quot;&quot;,
                 descr=&quot;&quot;,
                 user=current user)</code></pre><p>Exports the graph to the file <code>fname</code> using the computation graph format (cgr). These kwargs are strings or values that are stored as comments in the file</p><ul><li><code>descr</code> of the graph</li><li><code>fun</code> function it approximates</li><li><code>dom</code> domain it approximates</li><li><code>err</code> error in this domain</li><li><code>genby</code> script that generated this file</li><li><code>user</code> a username that created the file</li></ul><p>These kwarg influence how the graph is stored:</p><ul><li><code>order</code> specifies an order the graph nodes are stored</li><li><code>main_output</code> is a <code>Symbol</code> specifying what is the output.</li></ul><p>CGR format:</p><p>Every line corresponds to a node / operation. The syntax is matlab compatible, although <a href="../code_gen/#GraphMatFun.gen_code"><code>gen_code</code></a> produces faster matlab code.</p><p>See also <a href="#GraphMatFun.export_compgraph"><code>export_compgraph</code></a>.</p><p></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct_IO.jl#L5-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GraphMatFun.import_compgraph" href="#GraphMatFun.import_compgraph"><code>GraphMatFun.import_compgraph</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">graph=import_compgraph(fname)</code></pre><p>Reads a graph stored in the computation graph format (cgr) in the file <code>fname</code>.</p><p>See also <a href="#GraphMatFun.import_compgraph"><code>import_compgraph</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matrixfunctions/GraphMatFun.jl/blob/0126203b09996b95ce299925aca54acabd1322ba/src/compgraph_struct_IO.jl#L113-L119">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../generators/">Built-in graphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 30 June 2021 06:28">Wednesday 30 June 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
